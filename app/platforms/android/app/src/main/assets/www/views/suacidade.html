<div ng-controller="SampleCtrl">
    <md-toolbar style="background-color: #26A69A;">
        <div class="md-toolbar-tools">
            <md-button class="md-icon-button" aria-label="Back">
                <a href="#/home">
                    <md-icon md-svg-icon="img/icons/arrow-left.svg" style="color: #FFFFFF"></md-icon>
                </a>
            </md-button>
            <h2>
                <span style="color: #FFFFFF;">Sua cidade</span>
            </h2>
        </div>
    </md-toolbar>

    <style type="text/css">
      .inputdemoIcons .inputIconDemo { min-height: 48px; }
      .inputdemoIcons md-input-container:not(.md-input-invalid) > md-icon.email { color: green; }
      .inputdemoIcons md-input-container:not(.md-input-invalid) > md-icon.name { color: dodgerblue; }
      .inputdemoIcons md-input-container.md-input-invalid > md-icon.email,
      .inputdemoIcons md-input-container.md-input-invalid > md-icon.name { color: red; }
    </style>

     <div ng-controller="SampleCtrl" layout="column" layout-padding ng-cloak>
      <br/>
      <md-content class="md-no-momentum">      
        <md-input-container class="md-icon-float md-block">
          <label>Nome Completo</label>
          <input ng-model="user.nome" id="nome" type="text">
        </md-input-container>
   
        <md-input-container md-no-float class="md-block">
          <label>Cidade</label>
          <input ng-model="user.cidade" id="cidade" type="text">
        </md-input-container>

        <md-input-container md-no-float class="md-block">
         <label>Telefone</label>
          <input ng-model="user.telefone" id="telefone" type="text">
        </md-input-container>

        <md-input-container class="md-block">
          <label>Mensagem</label>
          <input md-maxlength="200" required md-no-asterisk name="Mensagem" id="mensagem" ng-model="user.mensagem">
        </md-input-container>
  
        <md-input-container md-no-float class="md-block">      
            <label>Envie uma Foto</label>
        </md-input-container>
        <br>
        <script src="https://smtpjs.com/v2/smtp.js"></script>
        <script type="text/javascript">

          var file = null;
          
          function load (evt) {
            console.log("entrou em load")
            console.log(evt)
            file = evt;
          }

          function send(){
            var tgt = file.target || window.event.srcElement,
                files = tgt.files;

            if (FileReader && files && files.length) {
                var fr = new FileReader();
                fr.onload = function () {
                    document.getElementById(outImage).src = fr.result;
                }
                fr.readAsBinaryString(files[0]);
                console.log(fr)
            }

            fr.onload = function () {
              var ref = firebase.storage().ref().child(document.getElementById("nome").value+".jpg");
              ref.putString(btoa(fr.result), 'base64').then(function(snapshot) {
                console.log('Uploaded a base64url string!');
              });

              Email.send(
                "contatonossodeputado@gmail.com",
                "biellnnunes@gmail.com",
                "Reposta do formul√°rio: Sua Cidade",
                "Nome: " + document.getElementById("nome").value + "<br>" +
                "Cidade: " + document.getElementById("cidade").value + "<br>" +
                "Telefone: " + document.getElementById("telefone").value + "<br>" +
                "Mensagem: " + document.getElementById("mensagem").value,
                {token: "376193ce-a168-4e13-9dac-19078e7b04d5"});
            };
            fr.onerror = function() {
                console.log("there are some problems");
            };
            setTimeout(function () {
                swal("Enviado!", "O problema da sua cidade foi cadastrado com sucesso!", "success");
            }, 1000);

            setTimeout(function () {
                window.location.href = '#/home';
            }, 2000);
          }

        </script>
      
        <div class="rows">
          <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
          <script type="text/javascript" src="js/a.js"></script>
  
          <input type="button" class="ax" value="Selecionar">
        
          <input type="file" name="arquivo" id="arquivo" onchange="load(event)" class="arquivo">
        
          <input type="text" name="file" id="file" class="file" placeholder="Nenhuma foto selecionada" readonly="readonly">
        
          <md-input-container md-no-float class="md-block">      
              <md-button 
                  type="submit" 
                  onclick="send()" 
                  style="
                      background-color: #26A69A; 
                      color: white">
                  Enviar
              </md-button>
          </md-input-container>
        </div>        
      </md-content>
    </div>
</div>
</div>